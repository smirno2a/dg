#include "IntPt.h"
#include "GaussLegendreSimplex.h"
//#include "Global.h"

/* constants for 4-point rule */
#define  a4  0.5854101966249685  
#define  b4  0.138196601125015  

/* constants for 5-point rule */
#define  a5  0.500000000000000  
#define  b5  0.166666666666667  

/* constants for 16-point rule */
#define  a16  0.0503737941001228  
#define  b16  0.0665420686332923  
#define  c16  0.7716429020672371  
#define  d16  0.0761190326442543  
#define  e16  0.1197005277978019  
#define  f16  0.0718316452676693  
#define  g16  0.4042339134672644  

/* constants for 17-point rule */
#define  a17  0.1884185567365411  
#define  b17  0.0670385837260428  
#define  c17  0.0452855923632739  
#define  p17  0.7316369079576180  
#define  q17  0.0894543640141273  
#define  e17  0.1325810999384657  
#define  f17  0.0245400397290300  
#define  g17  0.4214394310662522  

/* constants for 29-point rule */
#define  a29  0.0904012904601475  
#define  b29  0.0191198342789912  
#define  c29  0.0436149384066657  
#define  d29  0.0258116759619916  
#define  p29  0.8277192480479295  
#define  q29  0.0574269173173568  
#define  e29  0.0513518841255634  
#define  f29  0.4860510285706072  
#define  g29  0.2312985436519147  
#define  h29  0.2967538129690260  
#define  i29  0.6081079894015281  
#define  j29  0.0475690988147229  

/* constants for 31-point rule */
#define  a31  0.0009700176366843
#define  b31  0.0182642234661088
#define  c31  0.0105999415244142
#define  d31  0.0782131923303187
#define  e31  0.7653604230090440
#define  f31 -0.0625177401143299
#define  g31  0.1218432166639044
#define  h31  0.6344703500082868
#define  i31  0.0048914252630735
#define  j31  0.3325391644464206
#define  k31  0.0023825066607383
#define  l31  0.0275573192239851

/* constants for 45-point rule */
#define  a45 -0.0393270066412926*6
#define  b45  0.0040813160593427*6
#define  c45  0.1274709365666390
#define  d45  0.6175871903000830
#define  e45  0.0006580867733043*6
#define  f45  0.0320788303926323
#define  g45  0.9037635088221031
#define  h45  0.0043842588251228*6
#define  i45  0.0497770956432810
#define  j45  0.4502229043567190
#define  k45  0.0138300638425098*6
#define  l45  0.1837304473985499
#define  m45  0.3162695526014501
#define  n45  0.0042404374246837*6
#define  o45  0.2319010893971509
#define  p45  0.0229177878448171
#define  q45  0.5132800333608811
#define  r45  0.0022387397396142*6
#define  s45  0.0379700484718286
#define  t45  0.7303134278075384
#define  u45  0.1937464752488044

/* constants for 14 point rule  -  Alternate version for Tet 4*/ 
#define  a14  0.0031746031746032*6.
#define  b14  0.0147649707904968*6.
#define  c14  0.1005267652252045
#define  d14  0.6984197043243866
#define  e14  0.0221397911142651*6.
#define  f14  0.3143728734931922
#define  g14  0.0568813795204234 

/* constants for 24 point rule  -  Alternate version for Tet 6*/
#define  a24  0.0066537917096946*6.
#define  b24  0.2146028712591517
#define  c24  0.3561913862225450
#define  d24  0.0016795351758868*6.
#define  e24  0.0406739585346113
#define  f24  0.8779781243961660
#define  g24  0.0092261969239424*6.
#define  h24  0.3223378901422756
#define  i24  0.0329863295731731
#define  j24  0.0080357142857143*6.
#define  k24  0.0636610018750175
#define  l24  0.2696723314583159
#define  m24  0.6030056647916491

IntPt3d GQTet1[1] = { 
  {{.25,.25,.25},1.0} 
};

IntPt3d GQTet2[4] = {
  { {a4,b4,b4},.25 },
  { {b4,a4,b4},.25 },
  { {b4,b4,a4},.25 },
  { {b4,b4,b4},.25 }
};

IntPt3d GQTet3[5] = {
  {{0.25,0.25,0.25},-0.8},
  {{a5,b5,b5},0.45},
  {{b5,a5,b5},0.45},
  {{b5,b5,a5},0.45},
  {{b5,b5,b5},0.45}
};

/*** INITIAL VERSION OF TET4 - 16 point rule ***
IntPt3d GQTet4[16] = {
  {{c16,d16,d16},a16},
  {{d16,c16,d16},a16},
  {{d16,d16,c16},a16},
  {{d16,d16,d16},a16},
  {{e16,f16,g16},b16},
  {{f16,e16,g16},b16},
  {{e16,g16,g16},b16},
  {{f16,g16,g16},b16},
  {{g16,g16,e16},b16},
  {{g16,g16,f16},b16},
  {{g16,e16,f16},b16},
  {{g16,f16,e16},b16},
  {{e16,g16,f16},b16},
  {{f16,g16,e16},b16},
  {{g16,e16,g16},b16},
  {{g16,f16,g16},b16}
};
*/

IntPt3d GQTet4[14] = {
    {{0.5,0.5,0.0},a14},
    {{0.5,0.0,0.5},a14},
    {{0.0,0.5,0.5},a14},
    {{0.0,0.0,0.5},a14},
    {{0.0,0.5,0.0},a14},
    {{0.5,0.0,0.0},a14},
    
    {{c14,c14,c14},b14},
    {{c14,c14,d14},b14},
    {{c14,d14,c14},b14},
    {{d14,c14,c14},b14},
    
    {{f14,f14,f14},e14},
    {{f14,f14,g14},e14},
    {{f14,g14,f14},e14},
    {{g14,f14,f14},e14}
};


IntPt3d GQTet5[17] = {
  {{0.25,0.25,0.25},a17},
  {{p17,q17,q17},b17},
  {{q17,p17,q17},b17},
  {{q17,q17,p17},b17},
  {{q17,q17,q17},b17},
  {{e17,f17,g17},c17},
  {{f17,e17,g17},c17},
  {{e17,g17,g17},c17},
  {{f17,g17,g17},c17},
  {{g17,g17,e17},c17},
  {{g17,g17,f17},c17},
  {{g17,e17,f17},c17},
  {{g17,f17,e17},c17},
  {{e17,g17,f17},c17},
  {{f17,g17,e17},c17},
  {{g17,e17,g17},c17},
  {{g17,f17,g17},c17}
};

/*** INITIAL VERSION OF TET6 - 29 point rule ***
IntPt3d GQTet6[29] = {
  {{0.25,0.25,0.25},a29},
  
  {{p29,q29,q29},b29},
  {{q29,p29,q29},b29},
  {{q29,q29,p29},b29},
  {{q29,q29,q29},b29},
  
  {{e29,f29,g29},c29},
  {{f29,e29,g29},c29},
  {{e29,g29,g29},c29},
  {{f29,g29,g29},c29},
  {{g29,g29,e29},c29},
  {{g29,g29,f29},c29},
  {{g29,e29,f29},c29},
  {{g29,f29,e29},c29},
  {{e29,g29,f29},c29},
  {{f29,g29,e29},c29},
  {{g29,e29,g29},c29},
  {{g29,f29,g29},c29},
  
  {{h29,i29,j29},d29},
  {{i29,h29,j29},d29},
  {{h29,j29,j29},d29},
  {{i29,j29,j29},d29},
  {{j29,j29,h29},d29},
  {{j29,j29,i29},d29},
  {{j29,h29,i29},d29},
  {{j29,i29,h29},d29},
  {{h29,j29,i29},d29},
  {{i29,j29,h29},d29},
  {{j29,h29,j29},d29},
  {{j29,i29,j29},d29}
  
};
*/

IntPt3d GQTet6[24] = {
    {{b24,b24,b24},a24},
    {{b24,b24,c24},a24},
    {{b24,c24,b24},a24},
    {{c24,b24,b24},a24},
    
    {{e24,e24,e24},d24},
    {{e24,e24,f24},d24},
    {{e24,f24,e24},d24},
    {{f24,e24,e24},d24},
    
    {{h24,h24,h24},g24},
    {{h24,h24,i24},g24},
    {{h24,i24,h24},g24},
    {{i24,h24,h24},g24},
    
    {{k24,k24,l24},j24},
    {{k24,l24,k24},j24},
    {{l24,k24,k24},j24},
    {{k24,k24,m24},j24},
    {{k24,m24,k24},j24},
    {{m24,k24,k24},j24},
    {{k24,l24,m24},j24},
    {{k24,m24,l24},j24},
    {{l24,k24,m24},j24},
    {{m24,k24,l24},j24},
    {{l24,m24,k24},j24},
    {{m24,l24,k24},j24},
        
};

IntPt3d GQTet7[31] = {
    {{0.5,0.5,0.0},a31},
    {{0.5,0.0,0.5},a31},
    {{0.0,0.5,0.5},a31},
    {{0.0,0.0,0.5},a31},
    {{0.0,0.5,0.0},a31},
    {{0.5,0.0,0.0},a31},
    
    {{0.25,0.25,0.25},b31},
    
    {{d31,d31,d31},c31},
    {{d31,d31,e31},c31},
    {{d31,e31,d31},c31},
    {{e31,d31,d31},c31},
    
    {{g31,g31,g31},f31},
    {{g31,g31,h31},f31},
    {{g31,h31,g31},f31},
    {{h31,g31,g31},f31},
    
    {{j31,j31,j31},i31},
    {{j31,j31,k31},i31},
    {{j31,k31,j31},i31},
    {{k31,j31,j31},i31},
    
    {{0.1,0.1,0.2},l31},
    {{0.1,0.2,0.1},l31},
    {{0.2,0.1,0.1},l31},
    {{0.1,0.1,0.6},l31},
    {{0.1,0.6,0.1},l31},
    {{0.6,0.1,0.1},l31},
    {{0.1,0.2,0.6},l31},
    {{0.2,0.1,0.6},l31},
    {{0.2,0.6,0.1},l31},
    {{0.1,0.6,0.2},l31},
    {{0.6,0.1,0.2},l31},
    {{0.6,0.2,0.1},l31}
};

IntPt3d GQTet8[45] = {        
    {{0.25,0.25,0.25},a45},
    
    {{c45,c45,c45},b45},
    {{c45,c45,d45},b45},
    {{c45,d45,c45},b45},
    {{d45,c45,c45},b45},

    {{f45,f45,f45},e45},
    {{f45,f45,g45},e45},
    {{f45,g45,f45},e45},
    {{g45,f45,f45},e45},
    
    {{i45,i45,j45},h45},
    {{i45,j45,i45},h45},
    {{j45,i45,i45},h45},
    {{j45,j45,i45},h45},
    {{j45,i45,j45},h45},
    {{i45,j45,j45},h45},
    
    {{l45,l45,m45},k45},
    {{l45,m45,l45},k45},
    {{m45,l45,l45},k45},
    {{m45,m45,l45},k45},
    {{m45,l45,m45},k45},
    {{l45,m45,m45},k45},
    
    {{o45,o45,p45},n45},
    {{o45,p45,o45},n45},
    {{p45,o45,o45},n45},
    {{o45,o45,q45},n45},
    {{o45,q45,o45},n45},
    {{q45,o45,o45},n45},
    {{o45,p45,q45},n45},
    {{p45,o45,q45},n45},
    {{p45,q45,o45},n45},
    {{o45,q45,p45},n45},
    {{q45,o45,p45},n45},
    {{q45,p45,o45},n45},
    
    {{s45,s45,t45},r45},
    {{s45,t45,s45},r45},
    {{t45,s45,s45},r45},
    {{s45,s45,u45},r45},
    {{s45,u45,s45},r45},
    {{u45,s45,s45},r45},
    {{s45,t45,u45},r45},
    {{t45,s45,u45},r45},
    {{t45,u45,s45},r45},
    {{s45,u45,t45},r45},
    {{u45,s45,t45},r45},
    {{u45,t45,s45},r45}
};

IntPt3d * GQTet[9] = {GQTet1,GQTet1,GQTet2,GQTet3,GQTet4,GQTet5,GQTet6,GQTet7,GQTet8};
IntPt3d * GQTetDegen[17] = {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0};
int GQTetnPt[9] = {1,1,4,5,14,17,24,31,45};

IntPt3d *getGQTetPts(int order);
int getNGQTetPts(int order);

IntPt3d *getGQTetPts(int order)
{ 
  if(order < 9)
    return GQTet[order]; 

  int n = (order+4)/2;
  int index = n-5;
  if(!GQTetDegen[index]){
    int npts = n*n*n;
    GQTetDegen[index] = new IntPt3d[npts];
    GaussLegendreTet(n,n,n,GQTetDegen[index]);
  }
  return GQTetDegen[index]; 
}


int getNGQTetPts(int order)
{ 
  if(order < 9)
    return GQTetnPt[order]; 
  else{
    int n = (order+4)/2;
    return n*n*n;
  }
}
